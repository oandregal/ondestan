<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="Ondestan" metal:use-macro="load: main.pt">

  <div metal:fill-slot="head">
    <title i18n:translate="orders_list_title">Orders list - Ondest√°n</title>
  </div>

  <div metal:fill-slot="content">
    <div id="middle">
      <div class="middle align-right">
        <div id="left" class="app-welcome align-left" >
          <b><label i18n:translate="orders_list">Orders list</label></b>
          <b><label i18n:translate="successful_order" tal:condition="'form.submitted' in request.params and message == ''">Successful Order</label></b>
        </div>
        <div id="right" class="app-welcome align-right"><label>${message}</label></div>
      </div>
    </div>
    <div id="bottom" tal:switch="'form.submitted' in request.params and message == ''">
      <div class="bottom" tal:condition="not is_admin" tal:case="True">
        <label i18n:translate="new_order_instructions">Thanks for your order! Our team will get in touch with you soon.</label>
      </div>
      <div class="bottom" tal:condition="not is_admin" tal:case="False">
        <b><label i18n:translate="new_order_header">New Order</label></b><br/>
        <label>*</label><label i18n:translate="mandatory_fields">Mandatory fields</label>
        <form action="${request.route_url('orders')}" method="post">
          <table>
            <tr><td align="right" style="padding-right:10px"><label i18n:translate="number_units">Number of units</label>:</td><td><input type="text" id="units" name="units" value="${units}" onkeyup="checkFields()"/>*</td></tr>
            <tr><td align="right" style="padding-right:10px"><label i18n:translate="delivery_address">Delivery address</label>:</td><td><input type="text" id="address" name="address" value="${address}" onkeyup="checkFields()"/>*</td></tr>
            <tr><td></td><td align="right"><input id="submit" type="submit" name="form.submitted" i18n:attributes="value confirm_order" value="Confirm order"/></td></tr>
          </table>
        </form>
      </div>
      <div class="bottom">
        <table>
          <tr>
            <th tal:condition="is_admin" i18n:translate="order_user">User</th>
            <th i18n:translate="order_state">Order state</th>
            <th i18n:translate="number_units">Number of units</th>
            <th i18n:translate="delivery_address">Delivery address</th>
          </tr>
          <tr tal:repeat="order orders">
            <td tal:condition="is_admin">
              <label tal:content="order.user.login"/>
            </td>
            <td tal:switch="is_admin">
              <form tal:case="True" name="form_order_${order.id}" action="${request.route_url('orders')}" method="post">
                <input type="hidden" name="id" value="${order.id}"/>
                <select name="state" onchange="document.form_order_${order.id}['form.submitted'].click();">
                  <option value="0" tal:attributes="selected 'selected' if order.state == 0 else None" i18n:translate="order_state_0">Awaiting</option>
                  <option value="1" tal:attributes="selected 'selected' if order.state == 1 else None" i18n:translate="order_state_1">In process</option>
                </select>
                <input type="submit" name="form.submitted" style="display: none;"/>
              </form>
              <tal:block tal:case="False">
                <tal:block tal:switch="order.state">
                  <label tal:case="0" i18n:translate="order_state_0">Awaiting</label>
                  <label tal:case="1" i18n:translate="order_state_1">In process</label>
                </tal:block>
              </tal:block>
            </td>
            <td><label tal:content="order.units"/></td>
            <td><label tal:content="order.address"/></td>
          </tr>
        </table>
      </div>
    </div>
  </div>

</html>
